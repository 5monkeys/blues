{% extends 'uwsgi/default/vassal.ini' %}

{% block vassal -%}
socket = {{ socket|default('0.0.0.0:3031') }}
{% if gevent %}
{% for w in range(1, workers + 1) %}
attach-daemon = {{ virtualenv }}/bin/celery worker -n w{{ w }} --app={{ module }} -P gevent -c {{ gevent }} -l info --pidfile=/var/run/uwsgi/celery-w{{ w }}.pid --logfile=/var/log/uwsgi/celery-w{{ w }}.log
{% endfor %}
# attach-daemon = {{ virtualenv }}/bin/celery worker -n apa --app={{ module }} -P gevent -c {{ gevent }} -l info
# attach-daemon = {{ virtualenv }}/bin/celery multi start hej apa -P gevent -I {{ module }} -c {{ gevent }} -E -l info --pidfile=/var/run/uwsgi/celery-%%N.pid
{% else %}
attach-daemon = {{ virtualenv }}/bin/celery worker --app={{ module }} -l info -c {{ workers }}
{% endif %}
{%- endblock vassal %}
